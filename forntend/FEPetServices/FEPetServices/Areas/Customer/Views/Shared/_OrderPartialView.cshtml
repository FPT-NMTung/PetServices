@using FEPetServices.Form.OrdersForm;
@model List<OrderForm>

<link href="~/css/orders/stylesheet.css" rel="stylesheet" />
@foreach (var order in Model)
{
    RenderOrder(order);
}

@functions {
    void RenderOrder(OrderForm order)
    {
        double totalPrice = 0;

        <div class="work-container">
            <div class="work-container-inner">
                <h5>Order ID : @order.OrderId</h5>
                @if (@order.OrderStatus.Trim() == "Delivery")
                {
                    <span class="badge badge-info">Đang giao</span>
                }
                else if (@order.OrderStatus.Trim() == "Reject")
                {
                    <span class="badge badge-info">Đơn hàng bị huỷ</span>
                }
                else if (@order.OrderStatus.Trim() == "Waiting")
                {
                    <span class="badge badge-info">Đơn hàng đang chờ xử lý</span>
                }
                else if (@order.OrderStatus.Trim() == "Received")
                {
                    <span class="badge badge-info">Hoàn thành</span>
                }
            </div>
            <p><i class="far fa-calendar-alt"></i> @order.OrderDate</p>

            @if (order.OrderProductDetails != null && order.OrderProductDetails.Count > 0)
            {
                <div class="content-details">
                    <p class="bold-text">Thông tin sản phẩm đã được đặt hàng</p>
                    @foreach (var productDetail in order.OrderProductDetails)
                    {
                        totalPrice = totalPrice + (double)(productDetail.Quantity * productDetail.Price);
                        <div class="content-detail">
                            <div class="product-info">
                                <img src="@productDetail.Product.Picture" width="50" height="50" alt="Product Image">
                                <div class="product-info-detail">
                                    <p style="max-width:450px">@productDetail.Product.ProductName</p>
                                    <p style="font-size:.8rem;"><span>x</span>@productDetail.Quantity</p>
                                </div>
                            </div>
                            <p>@($"{(productDetail.Quantity * productDetail.Price):n0}".Replace(",", ".")) VNĐ</p>
                        </div>
                        <div></div>
                    }
                </div>
            }

            @if (order.BookingServicesDetails != null && order.BookingServicesDetails.Count > 0)
            {
                <div class="content-details">
                    <p class="bold-text">Thông tin dịch vụ đã được đặt hàng</p>
                    @foreach (var serviceDetail in order.BookingServicesDetails)
                    {
                        totalPrice = totalPrice + (double)serviceDetail.PriceService;
                        <div class="content-detail">
                            <div class="service-info">
                                <img src="@serviceDetail.Service.Picture" width="50" height="50" alt="Service Image">
                                <div class="service-info-detail">
                                    <p style="max-width:450px">@serviceDetail.Service.ServiceName</p>
                                    <p style="font-size:.8rem;"><span>Cân nặng thú cưng: </span>@serviceDetail.Weight Kg</p>
                                    @*     PartnerID*@
                                    <p style="font-size:.8rem;"><span>Đối tác:</span>@serviceDetail.PartnerInfoId</p>
                                </div>
                            </div>
                            <div class="content-detail-time-service">
                                <p style="font-size:.8rem;">Thời gian bắt đầu: @serviceDetail?.StartTime</p>
                                <p style="font-size:.8rem;">Thời gian kêt thúc: @serviceDetail?.EndTime</p>
                            </div>
                            <p>@($"{(serviceDetail.PriceService):n0}".Replace(",", ".")) VNĐ</p>
                        </div>
                    }
                </div>
            }

            @if (order.BookingRoomDetails != null && order.BookingRoomDetails.Count > 0)
            {
                <div class="content-details">
                    <p class="bold-text">Thông tin phòng đã được đặt hàng</p>
                    @foreach (var roomDetail in order.BookingRoomDetails)
                    {
                        totalPrice = totalPrice + (double)roomDetail.TotalPrice;
                        <div class="content-detail">
                            <div class="room-info">
                                <img src="@roomDetail.Room.Picture" width="50" height="50" alt="Room Image">
                                <div class="room-info-detail">
                                    <p style="max-width:800px">@roomDetail.Room.RoomName</p>
                                    @foreach (var roomService in order.BookingRoomServices)
                                    {
                                        <div class="room-info-detail-service">
                                            <p style="font-size:.8rem;">Dịch vụ: @roomService.Service.ServiceName</p>
                                            <p class="price-service-rooom" style="font-size:.8rem;">@($"{(roomService.PriceService):n0}".Replace(",", ".")) VNĐ</p>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                        <div class="content-detail-time">
                            <p style="font-size:.9rem;">Thời gian bắt đầu: @roomDetail.StartDate</p>
                            <p style="font-size:.9rem;">Thời gian kêt thúc: @roomDetail.EndDate</p>
                        </div>
                    }
                </div>
            }

            <div class="headel-content">
                <p>Tổng giá : </p>
                <p>@(totalPrice.ToString("n0").Replace(",", ".")) VNĐ</p>
            </div>
            <div class="work-container-inner">
                @if (order != null && order.TypePay != null && order.TypePay.Trim() == "cash")
                {
                    <p>Thanh toán trực tiếp</p>
                }
                @if (order != null && order.TypePay != null && @order.TypePay.Trim() == "vnpay")
                {
                    <p>Thanh toán bằng hình thức chuyển khoản</p>
                }
                @if (@order.StatusPayment == false)
                {
                    <span class="badge badge-info">Chưa thanh toán</span>
                }
                @if (@order.StatusPayment == true)
                {
                    <span class="badge badge-info">Đã thanh toán</span>
                }
            </div>
        </div>
    }
}
